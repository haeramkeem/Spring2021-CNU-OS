# [OS00] Prac05

Q1 - 1 : 실습1

![%5BOS00%5D%20Prac05%20314fe1568c4e4f1690117374b066743b/image1.png](%5BOS00%5D%20Prac05%20314fe1568c4e4f1690117374b066743b/image1.png)

Fork()로 자식 프로세스를 만든 후 부모 프로세스는 리턴값이 0이 아니기 때문에 2초동안 sleep에 들어가게 된다. 그리고 자식 프로세스는 리턴값이 0이기 때문에 if문에 걸려 var_pid값에 0이 저장되고, pid는 자식 프로세스의 pid 인 2195가, glob의 값과 var의 값은 if문의 내용에 따라 1씩 추가되어 각각 7과 89의 값을 출력하게 된다. 이후 부 모 프로세스가 sleep에서 깨어나게 되면 리턴값으로 받은 자식 프로세스의 pid가 var_pid에 저장되어 2195의 값 을 출력하고 pid값으로는 부모 프로세스의 pid인 2194가, glob와 var의 값은 자식 프로세스와는 독립적인 공간을 사용하므로 변경되지 않아 6과 88이 각각 출력되게 된다.

Q1 - 2 : 실습2

![%5BOS00%5D%20Prac05%20314fe1568c4e4f1690117374b066743b/image2.png](%5BOS00%5D%20Prac05%20314fe1568c4e4f1690117374b066743b/image2.png)

execve()함수는 입력받은 인자들을 이용해 새 프로세스를 실행시키고, 현재의 프로세스를 그것으로 대체하는 명 령어이다. 따라서 기존 프로세스의 printf부분은 execve()함수에 의해 다른 프로세스로 교체되므로 실행되지 못하 게 된다.

Q2 : 실습3, 4

실습3 결과

![%5BOS00%5D%20Prac05%20314fe1568c4e4f1690117374b066743b/image4.png](%5BOS00%5D%20Prac05%20314fe1568c4e4f1690117374b066743b/image4.png)

실습4 결과

![%5BOS00%5D%20Prac05%20314fe1568c4e4f1690117374b066743b/image3.png](%5BOS00%5D%20Prac05%20314fe1568c4e4f1690117374b066743b/image3.png)

실습3, 4의 차이점

실습 3의 경우는 하나의 프로세스, 하나의 메인 쓰레드로 실행이 되기 때문에 minus()함수가 종료되고 나서 plus() 함수가 실행되게 된다. 또한 각함수의 for문이 돌 때마다 sleep(1)에 들어가므로 1초에 한문장씩 출력된다. 따라서 pid, tid가 일정하고 glob의 값은 minus함수가 실행되는 동안은 꾸준히 감소하다 plus함수가 실행되면 꾸준히 증 가하는 것을 볼 수 있다. 또한 var값의 경우에도 마찬가지로 minus함수 실행 동안에는 9 -> 0으로 감소하고, plus 함수가 실행되면 새로운 변수이므로 11 -> 21로 증가하는 것을 볼 수 있다.

하지만 실습 4의 경우에는 프로세스는 하나지만 두개의 쓰레드에 의해 실행되므로 pid값은 일정한 것에 비해 tid 는 minus함수가 실행될때와 plus함수가 실행될때가 상이한 것을 볼 수 있다. 또한 쓰레드가 2개라는 것은 실행의 단위가 2개라는 소리와 같기 때문에 1초에 두 문장씩 출력되게 된다. glob의 값은 전역변수이므로 data에 저장되 어 두개의 쓰레드가 공유하기 때문에 값이 쓰레드가 하나일때와는 다르게 2 혹은 3에서 변화하는 것을 볼 수 있다. 하지만 var값은 지역변수로써 stack에 저장되기 때문에 두개의 쓰레드가 공유하지 않아 각각의 연산을 수행하는 것을 볼 수 있다

Q3 : execve()함수를 응용한 다른 명령어를 실행시키기

path값에 “/bin/touch”를 넣고, argv의 값으로 {“/bin/touch”, “201702004”, NULL}을, envp에 {NULL}의 값을 준 후 execve()함수를 실행시켜 현재 디렉토리에 201702004의 이름을 가진 파일을 생성하는 프로그램이다.

![%5BOS00%5D%20Prac05%20314fe1568c4e4f1690117374b066743b/image5.png](%5BOS00%5D%20Prac05%20314fe1568c4e4f1690117374b066743b/image5.png)